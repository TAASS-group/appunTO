services:
  userservice-app:
    build:
      context: userservice
      args:
        firebase_service_account_file: firebase_service_account_file.json
    container_name: userservice-app
    depends_on:
      - userservice-db
      - eurekaserver-app
    networks:
      userservice-internal:
      internal:
        aliases:
          - userservice

  userservice-db:
    image: postgres
    container_name: userservice-db
    restart: unless-stopped
    volumes:
      - userservice-db-data:/var/lib/postgresql/data
    ports:
      - 5432:5432
    environment:
      POSTGRES_USER: admin
      POSTGRES_PASSWORD: password
    networks:
      userservice-internal:
        aliases:
          - userservicedb

  apigateway-app:
    build:
      context: apigateway
    container_name: apigateway-app
    depends_on:
      - eurekaserver-app
    ports:
      - 8080:8080
    networks:
      - internal

  eurekaserver-app:
    build:
      context: eurekaServer
    container_name: eurekaserver-app
    ports:
      - 8761:8761
    networks:
      internal:
        aliases:
          - eurekaserver

#  rabbitmq:
#    build:
#      context: rabbitMQ
#    container_name: rabbitMQ
#    restart: unless-stopped
#    ports:
#      - 5672:5672
#      - 15672:15672 # management
#    networks:
#      - internal


volumes:
  userservice-db-data: {}

networks:
  internal : {}
  userservice-internal: {}
